---
layout: template
title: API - pyseext.menu_helper
permalink: /api//menu_helper
link_group: api
---
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pyseext" href="index.html">pyseext</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pyseext.menu_helper.MenuHelper" href="#pyseext.menu_helper.MenuHelper">MenuHelper</a></code></h4>
<ul class="">
<li><code><a title="pyseext.menu_helper.MenuHelper.check_menu_item_disabled" href="#pyseext.menu_helper.MenuHelper.check_menu_item_disabled">check_menu_item_disabled</a></code></li>
<li><code><a title="pyseext.menu_helper.MenuHelper.check_menu_item_enabled" href="#pyseext.menu_helper.MenuHelper.check_menu_item_enabled">check_menu_item_enabled</a></code></li>
<li><code><a title="pyseext.menu_helper.MenuHelper.click_menu_item" href="#pyseext.menu_helper.MenuHelper.click_menu_item">click_menu_item</a></code></li>
<li><code><a title="pyseext.menu_helper.MenuHelper.click_menu_item_by_text" href="#pyseext.menu_helper.MenuHelper.click_menu_item_by_text">click_menu_item_by_text</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<article id="content">
<header>
<h1 class="title">Module <code>pyseext.menu_helper</code></h1>
</header>
<section id="section-intro">
<p>Module that contains our MenuHelper class.</p>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/westy/pyseext/blob/master/pyseext/menu_helper.py#L1-L94" class="git-link">View at GitHub</a>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Module that contains our MenuHelper class.
&#34;&#34;&#34;
import logging
from typing import Union

from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.remote.webdriver import WebDriver

from pyseext.component_query import ComponentQuery

class MenuHelper:
    &#34;&#34;&#34;A class to help with interacting with Ext menus and menu items
    &#34;&#34;&#34;

    # Class variables
    _ENABLED_MENU_ITEM_TEMPLATE: str = &#39;menuitem[text=&#34;{text}&#34;][disabled=false]&#39;
    &#34;&#34;&#34;The component query template to use to find an enabled menu item.
    Requires the inserts: {text}&#34;&#34;&#34;

    _DISABLED_MENU_ITEM_TEMPLATE: str = &#39;menuitem[text=&#34;{text}&#34;][disabled=true]&#39;
    &#34;&#34;&#34;The component query template to use to find a disbled menu item.
    Requires the inserts: {text}&#34;&#34;&#34;

    def __init__(self, driver: WebDriver):
        &#34;&#34;&#34;Initialises an instance of this class

        Args:
            driver (WebDriver): The webdriver to use
        &#34;&#34;&#34;

        # Instance variables
        self._logger = logging.getLogger(__name__)
        &#34;&#34;&#34;The Logger instance for this class instance&#34;&#34;&#34;

        self._cq = ComponentQuery(driver)
        &#34;&#34;&#34;The `ComponentQuery` instance for this class instance&#34;&#34;&#34;

        self._action_chains = ActionChains(driver)
        &#34;&#34;&#34;The ActionChains instance for this class instance&#34;&#34;&#34;

    def click_menu_item(self, cq: str, root_id: Union[str, None] = None):
        &#34;&#34;&#34;Finds a menu item using the supplied component query and clicks it.

        Args:
            cq (str): The component query to find the menu item.
            root_id (str, optional): The id of the container within which to perform the query.
                                     If omitted, all components within the document are included in the search.
        &#34;&#34;&#34;
        menu_item = self._cq.wait_for_single_query_visible(cq, root_id)

        # Rather than call click, move mouse to button and click...
        self._logger.info(&#34;Clicking menu item with CQ &#39;%s&#39;&#34;, cq)

        self._action_chains.move_to_element(menu_item)
        self._action_chains.click()
        self._action_chains.perform()

    def click_menu_item_by_text(self, text: str, root_id: Union[str, None] = None):
        &#34;&#34;&#34;Finds a visible, enabled menu item with the specified text and clicks it.

        Args:
            text (str): The text on the menu item
            root_id (str, optional): The id of the container within which to perform the query.
                If omitted, all components within the document are included in the search.
        &#34;&#34;&#34;
        menu_item = self._cq.wait_for_single_query_visible(self._ENABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)

        # Rather than call click, move mouse to the menu item and click...
        self._logger.info(&#34;Clicking menu item &#39;%s&#39;&#34;, text)

        self._action_chains.move_to_element(menu_item)
        self._action_chains.click()
        self._action_chains.perform()

    def check_menu_item_enabled(self, text: str, root_id: Union[str, None] = None):
        &#34;&#34;&#34;Checks that we can find an enabled menu item with the specified text.

        Args:
            text (str): The text on the menu item
            root_id (str, optional): The id of the container within which to perform the query.
                If omitted, all components within the document are included in the search.
        &#34;&#34;&#34;
        self._cq.wait_for_single_query(self._ENABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)

    def check_menu_item_disabled(self, text: str, root_id:Union[str, None] = None):
        &#34;&#34;&#34;Checks that we can find a disabled menu item with the specified text.

        Args:
            text (str): The text on the menu item
            root_id (str, optional): The id of the container within which to perform the query.
                If omitted, all components within the document are included in the search.
        &#34;&#34;&#34;
        self._cq.wait_for_single_query(self._DISABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pyseext.menu_helper.MenuHelper"><code class="flex name class">
<span>class <span class="ident">MenuHelper</span></span>
<span>(</span><span>driver:Â selenium.webdriver.remote.webdriver.WebDriver)</span>
</code></dt>
<dd>
<section class="desc"><p>A class to help with interacting with Ext menus and menu items</p>
<p>Initialises an instance of this class</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>driver</code></strong> :&ensp;<code>WebDriver</code></dt>
<dd>The webdriver to use</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/westy/pyseext/blob/master/pyseext/menu_helper.py#L12-L94" class="git-link">View at GitHub</a>
</summary>
<pre><code class="python">class MenuHelper:
    &#34;&#34;&#34;A class to help with interacting with Ext menus and menu items
    &#34;&#34;&#34;

    # Class variables
    _ENABLED_MENU_ITEM_TEMPLATE: str = &#39;menuitem[text=&#34;{text}&#34;][disabled=false]&#39;
    &#34;&#34;&#34;The component query template to use to find an enabled menu item.
    Requires the inserts: {text}&#34;&#34;&#34;

    _DISABLED_MENU_ITEM_TEMPLATE: str = &#39;menuitem[text=&#34;{text}&#34;][disabled=true]&#39;
    &#34;&#34;&#34;The component query template to use to find a disbled menu item.
    Requires the inserts: {text}&#34;&#34;&#34;

    def __init__(self, driver: WebDriver):
        &#34;&#34;&#34;Initialises an instance of this class

        Args:
            driver (WebDriver): The webdriver to use
        &#34;&#34;&#34;

        # Instance variables
        self._logger = logging.getLogger(__name__)
        &#34;&#34;&#34;The Logger instance for this class instance&#34;&#34;&#34;

        self._cq = ComponentQuery(driver)
        &#34;&#34;&#34;The `ComponentQuery` instance for this class instance&#34;&#34;&#34;

        self._action_chains = ActionChains(driver)
        &#34;&#34;&#34;The ActionChains instance for this class instance&#34;&#34;&#34;

    def click_menu_item(self, cq: str, root_id: Union[str, None] = None):
        &#34;&#34;&#34;Finds a menu item using the supplied component query and clicks it.

        Args:
            cq (str): The component query to find the menu item.
            root_id (str, optional): The id of the container within which to perform the query.
                                     If omitted, all components within the document are included in the search.
        &#34;&#34;&#34;
        menu_item = self._cq.wait_for_single_query_visible(cq, root_id)

        # Rather than call click, move mouse to button and click...
        self._logger.info(&#34;Clicking menu item with CQ &#39;%s&#39;&#34;, cq)

        self._action_chains.move_to_element(menu_item)
        self._action_chains.click()
        self._action_chains.perform()

    def click_menu_item_by_text(self, text: str, root_id: Union[str, None] = None):
        &#34;&#34;&#34;Finds a visible, enabled menu item with the specified text and clicks it.

        Args:
            text (str): The text on the menu item
            root_id (str, optional): The id of the container within which to perform the query.
                If omitted, all components within the document are included in the search.
        &#34;&#34;&#34;
        menu_item = self._cq.wait_for_single_query_visible(self._ENABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)

        # Rather than call click, move mouse to the menu item and click...
        self._logger.info(&#34;Clicking menu item &#39;%s&#39;&#34;, text)

        self._action_chains.move_to_element(menu_item)
        self._action_chains.click()
        self._action_chains.perform()

    def check_menu_item_enabled(self, text: str, root_id: Union[str, None] = None):
        &#34;&#34;&#34;Checks that we can find an enabled menu item with the specified text.

        Args:
            text (str): The text on the menu item
            root_id (str, optional): The id of the container within which to perform the query.
                If omitted, all components within the document are included in the search.
        &#34;&#34;&#34;
        self._cq.wait_for_single_query(self._ENABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)

    def check_menu_item_disabled(self, text: str, root_id:Union[str, None] = None):
        &#34;&#34;&#34;Checks that we can find a disabled menu item with the specified text.

        Args:
            text (str): The text on the menu item
            root_id (str, optional): The id of the container within which to perform the query.
                If omitted, all components within the document are included in the search.
        &#34;&#34;&#34;
        self._cq.wait_for_single_query(self._DISABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="pyseext.menu_helper.MenuHelper.check_menu_item_disabled">
<code class="name flex">
<span>def <span class="ident">check_menu_item_disabled</span></span>(<span>self, text:Â str, root_id:Â Optional[str]Â =Â None)</span>
</code>
</dt>
<dd>
<section class="desc"><p>Checks that we can find a disabled menu item with the specified text.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>text</code></strong> :&ensp;<code>str</code></dt>
<dd>The text on the menu item</dd>
<dt><strong><code>root_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The id of the container within which to perform the query.
If omitted, all components within the document are included in the search.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/westy/pyseext/blob/master/pyseext/menu_helper.py#L86-L94" class="git-link">View at GitHub</a>
</summary>
<pre><code class="python">def check_menu_item_disabled(self, text: str, root_id:Union[str, None] = None):
    &#34;&#34;&#34;Checks that we can find a disabled menu item with the specified text.

    Args:
        text (str): The text on the menu item
        root_id (str, optional): The id of the container within which to perform the query.
            If omitted, all components within the document are included in the search.
    &#34;&#34;&#34;
    self._cq.wait_for_single_query(self._DISABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)</code></pre>
</details>
</dd>
<dt id="pyseext.menu_helper.MenuHelper.check_menu_item_enabled">
<code class="name flex">
<span>def <span class="ident">check_menu_item_enabled</span></span>(<span>self, text:Â str, root_id:Â Optional[str]Â =Â None)</span>
</code>
</dt>
<dd>
<section class="desc"><p>Checks that we can find an enabled menu item with the specified text.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>text</code></strong> :&ensp;<code>str</code></dt>
<dd>The text on the menu item</dd>
<dt><strong><code>root_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The id of the container within which to perform the query.
If omitted, all components within the document are included in the search.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/westy/pyseext/blob/master/pyseext/menu_helper.py#L76-L84" class="git-link">View at GitHub</a>
</summary>
<pre><code class="python">def check_menu_item_enabled(self, text: str, root_id: Union[str, None] = None):
    &#34;&#34;&#34;Checks that we can find an enabled menu item with the specified text.

    Args:
        text (str): The text on the menu item
        root_id (str, optional): The id of the container within which to perform the query.
            If omitted, all components within the document are included in the search.
    &#34;&#34;&#34;
    self._cq.wait_for_single_query(self._ENABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)</code></pre>
</details>
</dd>
<dt id="pyseext.menu_helper.MenuHelper.click_menu_item">
<code class="name flex">
<span>def <span class="ident">click_menu_item</span></span>(<span>self, cq:Â str, root_id:Â Optional[str]Â =Â None)</span>
</code>
</dt>
<dd>
<section class="desc"><p>Finds a menu item using the supplied component query and clicks it.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>cq</code></strong> :&ensp;<code>str</code></dt>
<dd>The component query to find the menu item.</dd>
<dt><strong><code>root_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The id of the container within which to perform the query.
If omitted, all components within the document are included in the search.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/westy/pyseext/blob/master/pyseext/menu_helper.py#L42-L57" class="git-link">View at GitHub</a>
</summary>
<pre><code class="python">def click_menu_item(self, cq: str, root_id: Union[str, None] = None):
    &#34;&#34;&#34;Finds a menu item using the supplied component query and clicks it.

    Args:
        cq (str): The component query to find the menu item.
        root_id (str, optional): The id of the container within which to perform the query.
                                 If omitted, all components within the document are included in the search.
    &#34;&#34;&#34;
    menu_item = self._cq.wait_for_single_query_visible(cq, root_id)

    # Rather than call click, move mouse to button and click...
    self._logger.info(&#34;Clicking menu item with CQ &#39;%s&#39;&#34;, cq)

    self._action_chains.move_to_element(menu_item)
    self._action_chains.click()
    self._action_chains.perform()</code></pre>
</details>
</dd>
<dt id="pyseext.menu_helper.MenuHelper.click_menu_item_by_text">
<code class="name flex">
<span>def <span class="ident">click_menu_item_by_text</span></span>(<span>self, text:Â str, root_id:Â Optional[str]Â =Â None)</span>
</code>
</dt>
<dd>
<section class="desc"><p>Finds a visible, enabled menu item with the specified text and clicks it.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>text</code></strong> :&ensp;<code>str</code></dt>
<dd>The text on the menu item</dd>
<dt><strong><code>root_id</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The id of the container within which to perform the query.
If omitted, all components within the document are included in the search.</dd>
</dl></section>
<details class="source">
<summary>
<span>Expand source code</span>
<a href="https://github.com/westy/pyseext/blob/master/pyseext/menu_helper.py#L59-L74" class="git-link">View at GitHub</a>
</summary>
<pre><code class="python">def click_menu_item_by_text(self, text: str, root_id: Union[str, None] = None):
    &#34;&#34;&#34;Finds a visible, enabled menu item with the specified text and clicks it.

    Args:
        text (str): The text on the menu item
        root_id (str, optional): The id of the container within which to perform the query.
            If omitted, all components within the document are included in the search.
    &#34;&#34;&#34;
    menu_item = self._cq.wait_for_single_query_visible(self._ENABLED_MENU_ITEM_TEMPLATE.format(text=text), root_id)

    # Rather than call click, move mouse to the menu item and click...
    self._logger.info(&#34;Clicking menu item &#39;%s&#39;&#34;, text)

    self._action_chains.move_to_element(menu_item)
    self._action_chains.click()
    self._action_chains.perform()</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite>.</p>
</footer>